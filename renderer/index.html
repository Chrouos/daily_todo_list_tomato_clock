<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pomodoro Timer</title>
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <main class="app">
      <header class="app__header">
        <h1>Pomodoro Timer</h1>
        <p class="app__tagline">保持節奏、專注工作</p>
      </header>

      <nav class="app-tabs" role="tablist">
        <button class="app-tabs__tab app-tabs__tab--active" data-tab="home" role="tab" aria-selected="true">
          Home
        </button>
        <button class="app-tabs__tab" data-tab="settings" role="tab" aria-selected="false">
          Settings
        </button>
        <button class="app-tabs__tab" data-tab="logs" role="tab" aria-selected="false">
          Logs
        </button>
        <button class="app-tabs__tab" data-tab="timeline" role="tab" aria-selected="false">
          Timeline
        </button>
        <button class="app-tabs__tab" data-tab="todo" role="tab" aria-selected="false">
          Todo
        </button>
      </nav>

      <section class="app-panels">
        <section class="app-panel app-panel--active" data-panel="home" role="tabpanel">
          <section class="timer">
            <div class="timer__display" id="timeDisplay">25:00</div>
            <div class="timer__progress">
              <div class="timer__progress-bar" id="progressBar"></div>
            </div>
          </section>

          <section class="status">
            <span class="status__phase" id="phaseChip">專注</span>
            <label class="category-selector" for="categorySelect">
              <span class="category-selector__label">分類</span>
              <select id="categorySelect" class="category-selector__select"></select>
            </label>
          </section>

          <section class="current-todo" id="currentTodo">
            <div class="current-todo__info">
              <span class="current-todo__label">目前待辦</span>
              <p class="current-todo__title" id="currentTodoTitle">未選擇</p>
              <p class="current-todo__tags" id="currentTodoTags"></p>
            </div>
            <div class="current-todo__actions">
              <button type="button" id="clearActiveTodoBtn" class="btn btn--ghost" hidden>取消選擇</button>
            </div>
          </section>

          <section class="controls">
            <button id="startBtn" class="btn btn--primary">Start</button>
            <button id="pauseBtn" class="btn">Pause</button>
            <button id="resetBtn" class="btn">Reset</button>
            <button id="addTimeBtn" class="btn">+1 min</button>
            <button id="subtractTimeBtn" class="btn">-1 min</button>
          </section>
        </section>

        <section class="app-panel" data-panel="settings" role="tabpanel" hidden>
          <div class="panel-grid">
            <div class="panel-card">
              <h2>分類管理</h2>
              <form id="categoryForm" class="category-form" autocomplete="off">
                <input
                  type="text"
                  id="categoryInput"
                  placeholder="新增分類名稱"
                  maxlength="40"
                />
                <div class="category-form__actions">
                  <button type="submit" class="btn btn--primary">新增</button>
                </div>
              </form>
              <ul class="category-list" id="categoryList"></ul>
            </div>

            <div class="panel-card">
              <h2>時間設定</h2>
              <form id="settingsForm" class="settings__form">
                <div class="field">
                  <label for="focusInput">Focus (minutes)</label>
                  <input type="number" id="focusInput" min="1" max="120" value="25" />
                </div>
                <div class="field">
                  <label for="shortBreakInput">Short Break (minutes)</label>
                  <input type="number" id="shortBreakInput" min="1" max="60" value="5" />
                </div>
                <div class="field">
                  <label for="longBreakInput">Long Break (minutes)</label>
                  <input type="number" id="longBreakInput" min="1" max="90" value="15" />
                </div>
                <div class="field">
                  <label for="longBreakIntervalInput">Long Break After (cycles)</label>
                  <input type="number" id="longBreakIntervalInput" min="1" max="12" value="4" />
                </div>
                <div class="field field--inline">
                  <label for="autoStartBreaks">Auto start breaks</label>
                  <input type="checkbox" id="autoStartBreaks" checked />
                </div>
                <div class="settings__actions">
                  <button type="submit" class="btn btn--primary">Apply</button>
                </div>
              </form>
            </div>
          </div>
        </section>

        <section class="app-panel" data-panel="logs" role="tabpanel" hidden>
          <div class="panel-card">
            <div class="panel-card__header">
              <h2>番茄鐘紀錄</h2>
              <button type="button" id="clearHistoryBtn" class="btn btn--ghost">清除紀錄</button>
            </div>
            <ul class="history__list" id="historyList"></ul>
          </div>
        </section>

        <section class="app-panel" data-panel="timeline" role="tabpanel" hidden>
          <div class="panel-card">
            <div class="panel-card__header">
              <h2>每日時間線</h2>
            </div>
            <div class="timeline" id="timeline"></div>
          </div>
        </section>

        <section class="app-panel" data-panel="todo" role="tabpanel" hidden>
          <div class="panel-card">
            <div class="panel-card__header">
              <h2>Todo List</h2>
              <button type="button" id="clearTodosBtn" class="btn btn--ghost">清除完成項目</button>
            </div>
            <form id="todoForm" class="todo-form" autocomplete="off">
              <input
                type="text"
                id="todoInput"
                placeholder="新增待辦事項"
                maxlength="80"
              />
              <div class="todo-tags">
                <label for="todoTagsInput">標籤（逗號分隔，可點選建議新增）</label>
                <input
                  type="text"
                  id="todoTagsInput"
                  placeholder="例如：寫作, 研究"
                  maxlength="120"
                />
                <div class="todo-tags__suggestions" id="todoTagSuggestions"></div>
              </div>
              <div class="todo-form__actions">
                <button type="submit" class="btn btn--primary">新增</button>
              </div>
            </form>
            <ul class="todo-list" id="todoList"></ul>
          </div>
        </section>
      </section>
    </main>

    <div class="task-dialog-overlay" id="todoDiscussionOverlay" hidden>
      <div class="task-dialog-overlay__backdrop" data-dialog-close></div>
      <div class="task-dialog" role="dialog" aria-modal="true" aria-labelledby="todoDiscussionTitle">
        <header class="task-dialog__header">
          <div class="task-dialog__heading">
            <span class="task-dialog__label">Task</span>
            <h3 class="task-dialog__title" id="todoDiscussionTitle">—</h3>
          </div>
          <button type="button" class="task-dialog__close" id="todoDiscussionClose" aria-label="關閉">
            &times;
          </button>
        </header>
        <div class="task-dialog__body">
          <ul class="task-discussion" id="todoDiscussionList"></ul>
          <p class="task-discussion__empty" id="todoDiscussionEmpty" hidden>目前沒有紀錄，開始新增問題。</p>
        </div>
        <form class="task-dialog__form" id="todoDiscussionForm" autocomplete="off">
          <label for="todoDiscussionInput" class="task-dialog__form-label">新增遇到的問題</label>
          <textarea
            id="todoDiscussionInput"
            rows="3"
            maxlength="400"
            placeholder="簡單描述遇到的問題或想法..."
            required
          ></textarea>
          <div class="task-dialog__form-actions">
            <button type="submit" class="btn btn--primary">新增紀錄</button>
          </div>
        </form>
      </div>
    </div>

    <script type="module" src="./app.js"></script>
  </body>
</html>
